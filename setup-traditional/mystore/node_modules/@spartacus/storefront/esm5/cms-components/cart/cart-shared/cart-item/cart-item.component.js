import { __decorate } from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { PromotionLocation } from '@spartacus/core';
import { PromotionService } from '../../../../shared/services/promotion/promotion.service';
var CartItemComponent = /** @class */ (function () {
    function CartItemComponent(promotionService) {
        this.promotionService = promotionService;
        this.compact = false;
        this.readonly = false;
        this.view = new EventEmitter();
        this.promotionLocation = PromotionLocation.ActiveCart;
        // TODO: evaluate whether this is generic enough
        this.options = {
            isSaveForLater: false,
            optionalBtn: null,
        };
    }
    CartItemComponent.prototype.ngOnInit = function () {
        this.appliedProductPromotions$ = this.promotionService.getProductPromotionForEntry(this.item, this.promotionLocation);
    };
    CartItemComponent.prototype.isProductOutOfStock = function (product) {
        // TODO Move stocklevelstatuses across the app to an enum
        return (product &&
            product.stock &&
            product.stock.stockLevelStatus === 'outOfStock');
    };
    CartItemComponent.prototype.removeItem = function () {
        this.quantityControl.setValue(0);
        this.quantityControl.markAsDirty();
    };
    CartItemComponent.prototype.viewItem = function () {
        this.view.emit();
    };
    CartItemComponent.ctorParameters = function () { return [
        { type: PromotionService }
    ]; };
    __decorate([
        Input()
    ], CartItemComponent.prototype, "compact", void 0);
    __decorate([
        Input()
    ], CartItemComponent.prototype, "item", void 0);
    __decorate([
        Input()
    ], CartItemComponent.prototype, "readonly", void 0);
    __decorate([
        Input()
    ], CartItemComponent.prototype, "quantityControl", void 0);
    __decorate([
        Output()
    ], CartItemComponent.prototype, "view", void 0);
    __decorate([
        Input()
    ], CartItemComponent.prototype, "promotionLocation", void 0);
    __decorate([
        Input()
    ], CartItemComponent.prototype, "options", void 0);
    CartItemComponent = __decorate([
        Component({
            selector: 'cx-cart-item',
            template: "<div [ngClass]=\"compact ? 'cx-compact row' : 'row'\">\r\n  <!-- Item Image -->\r\n  <div class=\"col-2 cx-image-container\">\r\n    <a\r\n      [routerLink]=\"{ cxRoute: 'product', params: item.product } | cxUrl\"\r\n      (click)=\"viewItem()\"\r\n      tabindex=\"-1\"\r\n    >\r\n      <cx-media [container]=\"item.product.images?.PRIMARY\"></cx-media>\r\n    </a>\r\n  </div>\r\n  <!-- Item Information -->\r\n  <div class=\"cx-info col-10\">\r\n    <div class=\"cx-info-container row\">\r\n      <!-- Item Description -->\r\n      <div [ngClass]=\"compact ? '' : ' col-md-3 col-lg-3 col-xl-5'\">\r\n        <div *ngIf=\"item.product.name\" class=\"cx-name\">\r\n          <a\r\n            class=\"cx-link\"\r\n            [routerLink]=\"{ cxRoute: 'product', params: item.product } | cxUrl\"\r\n            (click)=\"viewItem()\"\r\n            >{{ item.product.name }}</a\r\n          >\r\n        </div>\r\n        <div *ngIf=\"item.product.code\" class=\"cx-code\">\r\n          {{ 'cartItems.id' | cxTranslate }} {{ item.product.code }}\r\n        </div>\r\n        <!-- Variants -->\r\n        <ng-container *ngIf=\"item.product.baseOptions?.length\">\r\n          <div\r\n            *ngFor=\"\r\n              let variant of item.product.baseOptions[0]?.selected\r\n                ?.variantOptionQualifiers\r\n            \"\r\n            class=\"cx-property\"\r\n          >\r\n            <div class=\"cx-label\" *ngIf=\"variant.name && variant.value\">\r\n              {{ variant.name }}: {{ variant.value }}\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n      <!-- Item Price -->\r\n      <div\r\n        *ngIf=\"item.basePrice\"\r\n        class=\"cx-price\"\r\n        [ngClass]=\"compact ? '' : ' col-md-3 col-lg-3 col-xl-2'\"\r\n      >\r\n        <div\r\n          class=\"cx-label\"\r\n          [ngClass]=\"compact ? '' : ' d-block d-md-none d-lg-none d-xl-none'\"\r\n        >\r\n          {{ 'cartItems.itemPrice' | cxTranslate }}\r\n        </div>\r\n        <div *ngIf=\"item.basePrice\" class=\"cx-value\">\r\n          {{ item.basePrice?.formattedValue }}\r\n        </div>\r\n      </div>\r\n      <!-- Item Quantity -->\r\n      <div class=\"cx-quantity\" [ngClass]=\"compact ? '' : ' col-3'\">\r\n        <div\r\n          class=\"cx-label\"\r\n          [ngClass]=\"compact ? '' : ' d-block d-md-none d-lg-none d-xl-none'\"\r\n          placement=\"left\"\r\n          title=\"{{ 'cartItems.quantityTitle' | cxTranslate }}\"\r\n        >\r\n          {{ 'cartItems.quantity' | cxTranslate }}\r\n        </div>\r\n        <div class=\"cx-value\">\r\n          <cx-item-counter\r\n            [control]=\"quantityControl\"\r\n            [readonly]=\"!item.updateable || readonly || options.isSaveForLater\"\r\n            [max]=\"item.product.stock?.stockLevel || 1000\"\r\n            [allowZero]=\"true\"\r\n          >\r\n          </cx-item-counter>\r\n        </div>\r\n      </div>\r\n      <!-- Total -->\r\n      <ng-container *ngIf=\"options.isSaveForLater; else total\">\r\n        <div\r\n          class=\"cx-total\"\r\n          [ngClass]=\"compact ? '' : ' col-md-3 col-lg-3 col-xl-2'\"\r\n        >\r\n          <div\r\n            class=\"cx-label\"\r\n            [ngClass]=\"compact ? '' : ' d-block d-md-none d-lg-none d-xl-none'\"\r\n          >\r\n            {{ 'saveForLaterItems.stock' | cxTranslate }}\r\n          </div>\r\n          <div\r\n            *ngIf=\"item.product?.stock?.stockLevel >= 0; else forceInstock\"\r\n            class=\"cx-value\"\r\n          >\r\n            {{ item.product.stock.stockLevel }}\r\n          </div>\r\n          <ng-template #forceInstock\r\n            ><div class=\"cx-value\">\r\n              {{ 'saveForLaterItems.forceInStock' | cxTranslate }}\r\n            </div></ng-template\r\n          >\r\n        </div>\r\n      </ng-container>\r\n    </div>\r\n    <!-- Availability -->\r\n    <div\r\n      *ngIf=\"isProductOutOfStock(item.product)\"\r\n      class=\"cx-availability col-12\"\r\n    >\r\n      {{ 'productSummary.outOfStock' | cxTranslate }}\r\n    </div>\r\n    <!-- Promotion -->\r\n\r\n    <ng-container\r\n      *ngIf=\"appliedProductPromotions$ | async as appliedProductPromotions\"\r\n    >\r\n      <cx-promotions [promotions]=\"appliedProductPromotions\"></cx-promotions>\r\n    </ng-container>\r\n\r\n    <!-- Actions -->\r\n    <div\r\n      *ngIf=\"(!readonly || options.isSaveForLater) && item.updateable\"\r\n      class=\"cx-actions col-12\"\r\n    >\r\n      <ng-container *ngIf=\"!isProductOutOfStock(item.product)\">\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            options.optionalBtn;\r\n            context: {\r\n              $implicit: { loading: quantityControl.disabled, item: item }\r\n            }\r\n          \"\r\n        ></ng-container>\r\n      </ng-container>\r\n\r\n      <div class=\"col-md-3 cx-remove-btn\">\r\n        <button\r\n          class=\"link cx-action-link\"\r\n          [disabled]=\"quantityControl.disabled\"\r\n          (click)=\"removeItem()\"\r\n        >\r\n          {{ 'common.remove' | cxTranslate }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #total>\r\n  <div\r\n    *ngIf=\"item.totalPrice\"\r\n    class=\"cx-total\"\r\n    [ngClass]=\"compact ? '' : ' col-md-3 col-xl-2'\"\r\n  >\r\n    <div\r\n      class=\"cx-label\"\r\n      [ngClass]=\"compact ? '' : ' d-block d-md-none d-lg-none d-xl-none'\"\r\n    >\r\n      {{ 'cartItems.total' | cxTranslate }}\r\n    </div>\r\n    <div class=\"cx-value\">{{ item.totalPrice.formattedValue }}</div>\r\n  </div>\r\n</ng-template>\r\n"
        })
    ], CartItemComponent);
    return CartItemComponent;
}());
export { CartItemComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FydC1pdGVtLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BzcGFydGFjdXMvc3RvcmVmcm9udC8iLCJzb3VyY2VzIjpbImNtcy1jb21wb25lbnRzL2NhcnQvY2FydC1zaGFyZWQvY2FydC1pdGVtL2NhcnQtaXRlbS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFL0UsT0FBTyxFQUFFLGlCQUFpQixFQUFtQixNQUFNLGlCQUFpQixDQUFDO0FBRXJFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHlEQUF5RCxDQUFDO0FBbUIzRjtJQWtCRSwyQkFBc0IsZ0JBQWtDO1FBQWxDLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFqQi9DLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFFaEIsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUdoQixTQUFJLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVoQyxzQkFBaUIsR0FBc0IsaUJBQWlCLENBQUMsVUFBVSxDQUFDO1FBRTdFLGdEQUFnRDtRQUN2QyxZQUFPLEdBQTZCO1lBQzNDLGNBQWMsRUFBRSxLQUFLO1lBQ3JCLFdBQVcsRUFBRSxJQUFJO1NBQ2xCLENBQUM7SUFJeUQsQ0FBQztJQUU1RCxvQ0FBUSxHQUFSO1FBQ0UsSUFBSSxDQUFDLHlCQUF5QixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQywyQkFBMkIsQ0FDaEYsSUFBSSxDQUFDLElBQUksRUFDVCxJQUFJLENBQUMsaUJBQWlCLENBQ3ZCLENBQUM7SUFDSixDQUFDO0lBRUQsK0NBQW1CLEdBQW5CLFVBQW9CLE9BQVk7UUFDOUIseURBQXlEO1FBQ3pELE9BQU8sQ0FDTCxPQUFPO1lBQ1AsT0FBTyxDQUFDLEtBQUs7WUFDYixPQUFPLENBQUMsS0FBSyxDQUFDLGdCQUFnQixLQUFLLFlBQVksQ0FDaEQsQ0FBQztJQUNKLENBQUM7SUFFRCxzQ0FBVSxHQUFWO1FBQ0UsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNyQyxDQUFDO0lBRUQsb0NBQVEsR0FBUjtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDbkIsQ0FBQzs7Z0JBekJ1QyxnQkFBZ0I7O0lBakIvQztRQUFSLEtBQUssRUFBRTtzREFBaUI7SUFDaEI7UUFBUixLQUFLLEVBQUU7bURBQVk7SUFDWDtRQUFSLEtBQUssRUFBRTt1REFBa0I7SUFDakI7UUFBUixLQUFLLEVBQUU7OERBQThCO0lBRTVCO1FBQVQsTUFBTSxFQUFFO21EQUFnQztJQUVoQztRQUFSLEtBQUssRUFBRTtnRUFBcUU7SUFHcEU7UUFBUixLQUFLLEVBQUU7c0RBR047SUFkUyxpQkFBaUI7UUFKN0IsU0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLGNBQWM7WUFDeEIsMmpMQUF5QztTQUMxQyxDQUFDO09BQ1csaUJBQWlCLENBNEM3QjtJQUFELHdCQUFDO0NBQUEsQUE1Q0QsSUE0Q0M7U0E1Q1ksaUJBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3JtQ29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgUHJvbW90aW9uTG9jYXRpb24sIFByb21vdGlvblJlc3VsdCB9IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgUHJvbW90aW9uU2VydmljZSB9IGZyb20gJy4uLy4uLy4uLy4uL3NoYXJlZC9zZXJ2aWNlcy9wcm9tb3Rpb24vcHJvbW90aW9uLnNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJdGVtIHtcclxuICBwcm9kdWN0PzogYW55O1xyXG4gIHF1YW50aXR5PzogYW55O1xyXG4gIGJhc2VQcmljZT86IGFueTtcclxuICB0b3RhbFByaWNlPzogYW55O1xyXG4gIHVwZGF0ZWFibGU/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENhcnRJdGVtQ29tcG9uZW50T3B0aW9ucyB7XHJcbiAgaXNTYXZlRm9yTGF0ZXI/OiBib29sZWFuO1xyXG4gIG9wdGlvbmFsQnRuPzogYW55O1xyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2N4LWNhcnQtaXRlbScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2NhcnQtaXRlbS5jb21wb25lbnQuaHRtbCcsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDYXJ0SXRlbUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQElucHV0KCkgY29tcGFjdCA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIGl0ZW06IEl0ZW07XHJcbiAgQElucHV0KCkgcmVhZG9ubHkgPSBmYWxzZTtcclxuICBASW5wdXQoKSBxdWFudGl0eUNvbnRyb2w6IEZvcm1Db250cm9sO1xyXG5cclxuICBAT3V0cHV0KCkgdmlldyA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBASW5wdXQoKSBwcm9tb3Rpb25Mb2NhdGlvbjogUHJvbW90aW9uTG9jYXRpb24gPSBQcm9tb3Rpb25Mb2NhdGlvbi5BY3RpdmVDYXJ0O1xyXG5cclxuICAvLyBUT0RPOiBldmFsdWF0ZSB3aGV0aGVyIHRoaXMgaXMgZ2VuZXJpYyBlbm91Z2hcclxuICBASW5wdXQoKSBvcHRpb25zOiBDYXJ0SXRlbUNvbXBvbmVudE9wdGlvbnMgPSB7XHJcbiAgICBpc1NhdmVGb3JMYXRlcjogZmFsc2UsXHJcbiAgICBvcHRpb25hbEJ0bjogbnVsbCxcclxuICB9O1xyXG5cclxuICBhcHBsaWVkUHJvZHVjdFByb21vdGlvbnMkOiBPYnNlcnZhYmxlPFByb21vdGlvblJlc3VsdFtdPjtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHByb21vdGlvblNlcnZpY2U6IFByb21vdGlvblNlcnZpY2UpIHt9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5hcHBsaWVkUHJvZHVjdFByb21vdGlvbnMkID0gdGhpcy5wcm9tb3Rpb25TZXJ2aWNlLmdldFByb2R1Y3RQcm9tb3Rpb25Gb3JFbnRyeShcclxuICAgICAgdGhpcy5pdGVtLFxyXG4gICAgICB0aGlzLnByb21vdGlvbkxvY2F0aW9uXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaXNQcm9kdWN0T3V0T2ZTdG9jayhwcm9kdWN0OiBhbnkpIHtcclxuICAgIC8vIFRPRE8gTW92ZSBzdG9ja2xldmVsc3RhdHVzZXMgYWNyb3NzIHRoZSBhcHAgdG8gYW4gZW51bVxyXG4gICAgcmV0dXJuIChcclxuICAgICAgcHJvZHVjdCAmJlxyXG4gICAgICBwcm9kdWN0LnN0b2NrICYmXHJcbiAgICAgIHByb2R1Y3Quc3RvY2suc3RvY2tMZXZlbFN0YXR1cyA9PT0gJ291dE9mU3RvY2snXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlSXRlbSgpIHtcclxuICAgIHRoaXMucXVhbnRpdHlDb250cm9sLnNldFZhbHVlKDApO1xyXG4gICAgdGhpcy5xdWFudGl0eUNvbnRyb2wubWFya0FzRGlydHkoKTtcclxuICB9XHJcblxyXG4gIHZpZXdJdGVtKCkge1xyXG4gICAgdGhpcy52aWV3LmVtaXQoKTtcclxuICB9XHJcbn1cclxuIl19