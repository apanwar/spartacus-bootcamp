import { __decorate, __read } from "tslib";
import { Component, ChangeDetectionStrategy } from '@angular/core';
import { ReturnRequestList, OrderReturnRequestService, TranslationService, } from '@spartacus/core';
import { combineLatest } from 'rxjs';
import { tap, map, filter, take } from 'rxjs/operators';
var OrderReturnRequestListComponent = /** @class */ (function () {
    function OrderReturnRequestListComponent(returnRequestService, translation) {
        var _this = this;
        this.returnRequestService = returnRequestService;
        this.translation = translation;
        this.PAGE_SIZE = 5;
        this.returnRequests$ = this.returnRequestService.getOrderReturnRequestList(this.PAGE_SIZE).pipe(tap(function (requestList) {
            if (requestList.pagination) {
                _this.sortType = requestList.pagination.sort;
            }
        }));
        /**
         * When "Order Return" feature is enabled, this component becomes one tab in
         * TabParagraphContainerComponent. This can be read from TabParagraphContainer.
         */
        this.tabTitleParam$ = this.returnRequests$.pipe(map(function (returnRequests) { return returnRequests.pagination.totalResults; }), filter(function (totalResults) { return totalResults !== undefined; }), take(1));
    }
    OrderReturnRequestListComponent.prototype.ngOnDestroy = function () {
        this.returnRequestService.clearOrderReturnRequestList();
    };
    OrderReturnRequestListComponent.prototype.changeSortCode = function (sortCode) {
        var event = {
            sortCode: sortCode,
            currentPage: 0,
        };
        this.sortType = sortCode;
        this.fetchReturnRequests(event);
    };
    OrderReturnRequestListComponent.prototype.pageChange = function (page) {
        var event = {
            sortCode: this.sortType,
            currentPage: page,
        };
        this.fetchReturnRequests(event);
    };
    OrderReturnRequestListComponent.prototype.getSortLabels = function () {
        return combineLatest([
            this.translation.translate('sorting.date'),
            this.translation.translate('sorting.rma'),
        ]).pipe(map(function (_a) {
            var _b = __read(_a, 2), textByDate = _b[0], textByRma = _b[1];
            return {
                byDate: textByDate,
                byRMA: textByRma,
            };
        }));
    };
    OrderReturnRequestListComponent.prototype.fetchReturnRequests = function (event) {
        this.returnRequestService.loadOrderReturnRequestList(this.PAGE_SIZE, event.currentPage, event.sortCode);
    };
    OrderReturnRequestListComponent.ctorParameters = function () { return [
        { type: OrderReturnRequestService },
        { type: TranslationService }
    ]; };
    OrderReturnRequestListComponent = __decorate([
        Component({
            selector: 'cx-order-return-request-list',
            template: "<ng-container *ngIf=\"returnRequests$ | async as returnRequests\">\n  <div class=\"container\">\n    <!-- BODY -->\n    <div class=\"cx-order-history-body\">\n      <ng-container *ngIf=\"returnRequests.pagination.totalResults > 0\">\n        <!-- Select Form and Pagination Top -->\n        <div class=\"cx-order-history-sort top row\">\n          <div\n            class=\"cx-order-history-form-group form-group col-sm-12 col-md-4 col-lg-4\"\n          >\n            <cx-sorting\n              [sortOptions]=\"returnRequests.sorts\"\n              [sortLabels]=\"getSortLabels() | async\"\n              (sortListEvent)=\"changeSortCode($event)\"\n              [selectedOption]=\"returnRequests.pagination.sort\"\n              placeholder=\"{{\n                'returnRequestList.sortByMostRecent' | cxTranslate\n              }}\"\n            ></cx-sorting>\n          </div>\n          <div class=\"cx-order-history-pagination\">\n            <cx-pagination\n              [pagination]=\"returnRequests.pagination\"\n              (viewPageEvent)=\"pageChange($event)\"\n            ></cx-pagination>\n          </div>\n        </div>\n        <!-- TABLE -->\n        <table class=\"table cx-order-history-table\">\n          <thead class=\"cx-order-history-thead-mobile\">\n            <th scope=\"col\">\n              {{ 'returnRequestList.returnRequestId' | cxTranslate }}\n            </th>\n            <th scope=\"col\">{{ 'returnRequestList.orderId' | cxTranslate }}</th>\n            <th scope=\"col\">\n              {{ 'returnRequestList.date' | cxTranslate }}\n            </th>\n            <th scope=\"col\">{{ 'returnRequestList.status' | cxTranslate }}</th>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let return of returnRequests.returnRequests\">\n              <td class=\"cx-order-history-code\">\n                <div class=\"d-md-none cx-order-history-label\">\n                  {{ 'returnRequestList.returnRequestId' | cxTranslate }}\n                </div>\n                <a\n                  [routerLink]=\"\n                    {\n                      cxRoute: 'returnRequestDetails',\n                      params: return\n                    } | cxUrl\n                  \"\n                  class=\"cx-order-history-value\"\n                >\n                  {{ return?.rma }}</a\n                >\n              </td>\n              <td class=\"cx-order-history-code\">\n                <div class=\"d-md-none cx-order-history-label\">\n                  {{ 'returnRequestList.orderId' | cxTranslate }}\n                </div>\n                <a\n                  [routerLink]=\"\n                    {\n                      cxRoute: 'orderDetails',\n                      params: return?.order\n                    } | cxUrl\n                  \"\n                  class=\"cx-order-history-value\"\n                >\n                  {{ return?.order?.code }}</a\n                >\n              </td>\n\n              <td class=\"cx-order-history-placed\">\n                <div class=\"d-md-none cx-order-history-label\">\n                  {{ 'returnRequestList.date' | cxTranslate }}\n                </div>\n                {{ return?.creationTime | cxDate: 'longDate' }}\n              </td>\n              <td class=\"cx-order-history-status\">\n                <div class=\"d-md-none cx-order-history-label\">\n                  {{ 'returnRequestList.status' | cxTranslate }}\n                </div>\n                {{\n                  'returnRequestList.statusDisplay'\n                    | cxTranslate: { context: return?.status }\n                }}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <!-- Select Form and Pagination Bottom -->\n        <div class=\"cx-order-history-sort bottom row\">\n          <div\n            class=\"cx-order-history-form-group form-group col-sm-12 col-md-4 col-lg-4\"\n          >\n            <cx-sorting\n              [sortOptions]=\"returnRequests.sorts\"\n              [sortLabels]=\"getSortLabels() | async\"\n              (sortListEvent)=\"changeSortCode($event)\"\n              [selectedOption]=\"returnRequests.pagination.sort\"\n              placeholder=\"{{\n                'returnRequestList.sortByMostRecent' | cxTranslate\n              }}\"\n            ></cx-sorting>\n          </div>\n          <div class=\"cx-order-history-pagination\">\n            <cx-pagination\n              [pagination]=\"returnRequests.pagination\"\n              (viewPageEvent)=\"pageChange($event)\"\n            ></cx-pagination>\n          </div>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n</ng-container>\n",
            changeDetection: ChangeDetectionStrategy.OnPush
        })
    ], OrderReturnRequestListComponent);
    return OrderReturnRequestListComponent;
}());
export { OrderReturnRequestListComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JkZXItcmV0dXJuLXJlcXVlc3QtbGlzdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3BhcnRhY3VzL3N0b3JlZnJvbnQvIiwic291cmNlcyI6WyJjbXMtY29tcG9uZW50cy9teWFjY291bnQvb3JkZXIvcmV0dXJuLXJlcXVlc3QtbGlzdC9vcmRlci1yZXR1cm4tcmVxdWVzdC1saXN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBYSx1QkFBdUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM5RSxPQUFPLEVBQ0wsaUJBQWlCLEVBQ2pCLHlCQUF5QixFQUN6QixrQkFBa0IsR0FDbkIsTUFBTSxpQkFBaUIsQ0FBQztBQUN6QixPQUFPLEVBQWMsYUFBYSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pELE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQU94RDtJQUNFLHlDQUNVLG9CQUErQyxFQUMvQyxXQUErQjtRQUZ6QyxpQkFHSTtRQUZNLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBMkI7UUFDL0MsZ0JBQVcsR0FBWCxXQUFXLENBQW9CO1FBR2pDLGNBQVMsR0FBRyxDQUFDLENBQUM7UUFHdEIsb0JBQWUsR0FFWCxJQUFJLENBQUMsb0JBQW9CLENBQUMseUJBQXlCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FDMUUsR0FBRyxDQUFDLFVBQUMsV0FBOEI7WUFDakMsSUFBSSxXQUFXLENBQUMsVUFBVSxFQUFFO2dCQUMxQixLQUFJLENBQUMsUUFBUSxHQUFHLFdBQVcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO2FBQzdDO1FBQ0gsQ0FBQyxDQUFDLENBQ0gsQ0FBQztRQUVGOzs7V0FHRztRQUNILG1CQUFjLEdBQXVCLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUM1RCxHQUFHLENBQUMsVUFBQyxjQUFjLElBQUssT0FBQSxjQUFjLENBQUMsVUFBVSxDQUFDLFlBQVksRUFBdEMsQ0FBc0MsQ0FBQyxFQUMvRCxNQUFNLENBQUMsVUFBQyxZQUFZLElBQUssT0FBQSxZQUFZLEtBQUssU0FBUyxFQUExQixDQUEwQixDQUFDLEVBQ3BELElBQUksQ0FBQyxDQUFDLENBQUMsQ0FDUixDQUFDO0lBdkJDLENBQUM7SUF5QkoscURBQVcsR0FBWDtRQUNFLElBQUksQ0FBQyxvQkFBb0IsQ0FBQywyQkFBMkIsRUFBRSxDQUFDO0lBQzFELENBQUM7SUFFRCx3REFBYyxHQUFkLFVBQWUsUUFBZ0I7UUFDN0IsSUFBTSxLQUFLLEdBQThDO1lBQ3ZELFFBQVEsVUFBQTtZQUNSLFdBQVcsRUFBRSxDQUFDO1NBQ2YsQ0FBQztRQUNGLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQsb0RBQVUsR0FBVixVQUFXLElBQVk7UUFDckIsSUFBTSxLQUFLLEdBQThDO1lBQ3ZELFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtZQUN2QixXQUFXLEVBQUUsSUFBSTtTQUNsQixDQUFDO1FBQ0YsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCx1REFBYSxHQUFiO1FBQ0UsT0FBTyxhQUFhLENBQUM7WUFDbkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDO1lBQzFDLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQztTQUMxQyxDQUFDLENBQUMsSUFBSSxDQUNMLEdBQUcsQ0FBQyxVQUFDLEVBQXVCO2dCQUF2QixrQkFBdUIsRUFBdEIsa0JBQVUsRUFBRSxpQkFBUztZQUN6QixPQUFPO2dCQUNMLE1BQU0sRUFBRSxVQUFVO2dCQUNsQixLQUFLLEVBQUUsU0FBUzthQUNqQixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUM7SUFFTyw2REFBbUIsR0FBM0IsVUFBNEIsS0FHM0I7UUFDQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsMEJBQTBCLENBQ2xELElBQUksQ0FBQyxTQUFTLEVBQ2QsS0FBSyxDQUFDLFdBQVcsRUFDakIsS0FBSyxDQUFDLFFBQVEsQ0FDZixDQUFDO0lBQ0osQ0FBQzs7Z0JBdkUrQix5QkFBeUI7Z0JBQ2xDLGtCQUFrQjs7SUFIOUIsK0JBQStCO1FBTDNDLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSw4QkFBOEI7WUFDeEMscW1KQUF5RDtZQUN6RCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtTQUNoRCxDQUFDO09BQ1csK0JBQStCLENBMEUzQztJQUFELHNDQUFDO0NBQUEsQUExRUQsSUEwRUM7U0ExRVksK0JBQStCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkRlc3Ryb3ksIENoYW5nZURldGVjdGlvblN0cmF0ZWd5IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgUmV0dXJuUmVxdWVzdExpc3QsXHJcbiAgT3JkZXJSZXR1cm5SZXF1ZXN0U2VydmljZSxcclxuICBUcmFuc2xhdGlvblNlcnZpY2UsXHJcbn0gZnJvbSAnQHNwYXJ0YWN1cy9jb3JlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgY29tYmluZUxhdGVzdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyB0YXAsIG1hcCwgZmlsdGVyLCB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdjeC1vcmRlci1yZXR1cm4tcmVxdWVzdC1saXN0JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vb3JkZXItcmV0dXJuLXJlcXVlc3QtbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmRlclJldHVyblJlcXVlc3RMaXN0Q29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmV0dXJuUmVxdWVzdFNlcnZpY2U6IE9yZGVyUmV0dXJuUmVxdWVzdFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHRyYW5zbGF0aW9uOiBUcmFuc2xhdGlvblNlcnZpY2VcclxuICApIHt9XHJcblxyXG4gIHByaXZhdGUgUEFHRV9TSVpFID0gNTtcclxuICBzb3J0VHlwZTogc3RyaW5nO1xyXG5cclxuICByZXR1cm5SZXF1ZXN0cyQ6IE9ic2VydmFibGU8XHJcbiAgICBSZXR1cm5SZXF1ZXN0TGlzdFxyXG4gID4gPSB0aGlzLnJldHVyblJlcXVlc3RTZXJ2aWNlLmdldE9yZGVyUmV0dXJuUmVxdWVzdExpc3QodGhpcy5QQUdFX1NJWkUpLnBpcGUoXHJcbiAgICB0YXAoKHJlcXVlc3RMaXN0OiBSZXR1cm5SZXF1ZXN0TGlzdCkgPT4ge1xyXG4gICAgICBpZiAocmVxdWVzdExpc3QucGFnaW5hdGlvbikge1xyXG4gICAgICAgIHRoaXMuc29ydFR5cGUgPSByZXF1ZXN0TGlzdC5wYWdpbmF0aW9uLnNvcnQ7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgKTtcclxuXHJcbiAgLyoqXHJcbiAgICogV2hlbiBcIk9yZGVyIFJldHVyblwiIGZlYXR1cmUgaXMgZW5hYmxlZCwgdGhpcyBjb21wb25lbnQgYmVjb21lcyBvbmUgdGFiIGluXHJcbiAgICogVGFiUGFyYWdyYXBoQ29udGFpbmVyQ29tcG9uZW50LiBUaGlzIGNhbiBiZSByZWFkIGZyb20gVGFiUGFyYWdyYXBoQ29udGFpbmVyLlxyXG4gICAqL1xyXG4gIHRhYlRpdGxlUGFyYW0kOiBPYnNlcnZhYmxlPG51bWJlcj4gPSB0aGlzLnJldHVyblJlcXVlc3RzJC5waXBlKFxyXG4gICAgbWFwKChyZXR1cm5SZXF1ZXN0cykgPT4gcmV0dXJuUmVxdWVzdHMucGFnaW5hdGlvbi50b3RhbFJlc3VsdHMpLFxyXG4gICAgZmlsdGVyKCh0b3RhbFJlc3VsdHMpID0+IHRvdGFsUmVzdWx0cyAhPT0gdW5kZWZpbmVkKSxcclxuICAgIHRha2UoMSlcclxuICApO1xyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMucmV0dXJuUmVxdWVzdFNlcnZpY2UuY2xlYXJPcmRlclJldHVyblJlcXVlc3RMaXN0KCk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VTb3J0Q29kZShzb3J0Q29kZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjb25zdCBldmVudDogeyBzb3J0Q29kZTogc3RyaW5nOyBjdXJyZW50UGFnZTogbnVtYmVyIH0gPSB7XHJcbiAgICAgIHNvcnRDb2RlLFxyXG4gICAgICBjdXJyZW50UGFnZTogMCxcclxuICAgIH07XHJcbiAgICB0aGlzLnNvcnRUeXBlID0gc29ydENvZGU7XHJcbiAgICB0aGlzLmZldGNoUmV0dXJuUmVxdWVzdHMoZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgcGFnZUNoYW5nZShwYWdlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGNvbnN0IGV2ZW50OiB7IHNvcnRDb2RlOiBzdHJpbmc7IGN1cnJlbnRQYWdlOiBudW1iZXIgfSA9IHtcclxuICAgICAgc29ydENvZGU6IHRoaXMuc29ydFR5cGUsXHJcbiAgICAgIGN1cnJlbnRQYWdlOiBwYWdlLFxyXG4gICAgfTtcclxuICAgIHRoaXMuZmV0Y2hSZXR1cm5SZXF1ZXN0cyhldmVudCk7XHJcbiAgfVxyXG5cclxuICBnZXRTb3J0TGFiZWxzKCk6IE9ic2VydmFibGU8eyBieURhdGU6IHN0cmluZzsgYnlSTUE6IHN0cmluZyB9PiB7XHJcbiAgICByZXR1cm4gY29tYmluZUxhdGVzdChbXHJcbiAgICAgIHRoaXMudHJhbnNsYXRpb24udHJhbnNsYXRlKCdzb3J0aW5nLmRhdGUnKSxcclxuICAgICAgdGhpcy50cmFuc2xhdGlvbi50cmFuc2xhdGUoJ3NvcnRpbmcucm1hJyksXHJcbiAgICBdKS5waXBlKFxyXG4gICAgICBtYXAoKFt0ZXh0QnlEYXRlLCB0ZXh0QnlSbWFdKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGJ5RGF0ZTogdGV4dEJ5RGF0ZSxcclxuICAgICAgICAgIGJ5Uk1BOiB0ZXh0QnlSbWEsXHJcbiAgICAgICAgfTtcclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZldGNoUmV0dXJuUmVxdWVzdHMoZXZlbnQ6IHtcclxuICAgIHNvcnRDb2RlOiBzdHJpbmc7XHJcbiAgICBjdXJyZW50UGFnZTogbnVtYmVyO1xyXG4gIH0pOiB2b2lkIHtcclxuICAgIHRoaXMucmV0dXJuUmVxdWVzdFNlcnZpY2UubG9hZE9yZGVyUmV0dXJuUmVxdWVzdExpc3QoXHJcbiAgICAgIHRoaXMuUEFHRV9TSVpFLFxyXG4gICAgICBldmVudC5jdXJyZW50UGFnZSxcclxuICAgICAgZXZlbnQuc29ydENvZGVcclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiJdfQ==