import { __decorate, __extends } from "tslib";
import { Injectable } from '@angular/core';
import { isCartNotFoundError } from '../../../../cart/utils/utils';
import { GlobalMessageType } from '../../../models/global-message.model';
import { HttpResponseStatus } from '../../../models/response-status.model';
import { HttpErrorHandler } from '../http-error.handler';
import * as i0 from "@angular/core";
import * as i1 from "../../../facade/global-message.service";
var OAUTH_ENDPOINT = '/authorizationserver/oauth/token';
var BadRequestHandler = /** @class */ (function (_super) {
    __extends(BadRequestHandler, _super);
    function BadRequestHandler() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.responseStatus = HttpResponseStatus.BAD_REQUEST;
        return _this;
    }
    BadRequestHandler.prototype.handleError = function (request, response) {
        this.handleBadPassword(request, response);
        this.handleBadLoginResponse(request, response);
        this.handleBadCartRequest(request, response);
        this.handleValidationError(request, response);
        this.handleVoucherOperationError(request, response);
    };
    BadRequestHandler.prototype.handleBadPassword = function (request, response) {
        var _a, _b, _c;
        if (((_a = response.url) === null || _a === void 0 ? void 0 : _a.includes(OAUTH_ENDPOINT)) &&
            ((_b = response.error) === null || _b === void 0 ? void 0 : _b.error) === 'invalid_grant' &&
            ((_c = request.body) === null || _c === void 0 ? void 0 : _c.get('grant_type')) === 'password') {
            this.globalMessageService.add({
                key: 'httpHandlers.badRequestPleaseLoginAgain',
                params: {
                    errorMessage: response.error.error_description || response.message || '',
                },
            }, GlobalMessageType.MSG_TYPE_ERROR);
            this.globalMessageService.remove(GlobalMessageType.MSG_TYPE_CONFIRMATION);
        }
    };
    BadRequestHandler.prototype.handleBadLoginResponse = function (_request, response) {
        var _this = this;
        this.getErrors(response)
            .filter(function (error) { return error.type === 'PasswordMismatchError'; })
            .forEach(function () {
            _this.globalMessageService.add({ key: 'httpHandlers.badRequestOldPasswordIncorrect' }, GlobalMessageType.MSG_TYPE_ERROR);
        });
    };
    BadRequestHandler.prototype.handleValidationError = function (_request, response) {
        var _this = this;
        this.getErrors(response)
            .filter(function (e) { return e.type === 'ValidationError'; })
            .forEach(function (error) {
            _this.globalMessageService.add({
                key: "httpHandlers.validationErrors." + error.reason + "." + error.subject,
            }, GlobalMessageType.MSG_TYPE_ERROR);
        });
    };
    BadRequestHandler.prototype.handleBadCartRequest = function (_request, response) {
        var _this = this;
        this.getErrors(response)
            .filter(function (e) { return isCartNotFoundError(e); })
            .forEach(function () {
            _this.globalMessageService.add({ key: 'httpHandlers.cartNotFound' }, GlobalMessageType.MSG_TYPE_ERROR);
        });
    };
    BadRequestHandler.prototype.handleVoucherOperationError = function (_request, response) {
        var _this = this;
        this.getErrors(response)
            .filter(function (e) {
            return e.message === 'coupon.invalid.code.provided' &&
                e.type === 'VoucherOperationError';
        })
            .forEach(function () {
            _this.globalMessageService.add({ key: 'httpHandlers.invalidCodeProvided' }, GlobalMessageType.MSG_TYPE_ERROR);
        });
    };
    BadRequestHandler.prototype.getErrors = function (response) {
        var _a;
        return (((_a = response.error) === null || _a === void 0 ? void 0 : _a.errors) || []).filter(function (error) { return error.type !== 'JaloObjectNoLongerValidError'; });
    };
    BadRequestHandler.prototype.getPriority = function () {
        return -10 /* LOW */;
    };
    BadRequestHandler.ɵprov = i0.ɵɵdefineInjectable({ factory: function BadRequestHandler_Factory() { return new BadRequestHandler(i0.ɵɵinject(i1.GlobalMessageService)); }, token: BadRequestHandler, providedIn: "root" });
    BadRequestHandler = __decorate([
        Injectable({
            providedIn: 'root',
        })
    ], BadRequestHandler);
    return BadRequestHandler;
}(HttpErrorHandler));
export { BadRequestHandler };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFkLXJlcXVlc3QuaGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BzcGFydGFjdXMvY29yZS8iLCJzb3VyY2VzIjpbInNyYy9nbG9iYWwtbWVzc2FnZS9odHRwLWludGVyY2VwdG9ycy9oYW5kbGVycy9iYWQtcmVxdWVzdC9iYWQtcmVxdWVzdC5oYW5kbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBR25FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQ3pFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQzNFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7QUFFekQsSUFBTSxjQUFjLEdBQUcsa0NBQWtDLENBQUM7QUFLMUQ7SUFBdUMscUNBQWdCO0lBQXZEO1FBQUEscUVBeUdDO1FBeEdDLG9CQUFjLEdBQUcsa0JBQWtCLENBQUMsV0FBVyxDQUFDOztLQXdHakQ7SUF0R0MsdUNBQVcsR0FBWCxVQUFZLE9BQXlCLEVBQUUsUUFBMkI7UUFDaEUsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztRQUMxQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQy9DLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsMkJBQTJCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFFUyw2Q0FBaUIsR0FBM0IsVUFDRSxPQUF5QixFQUN6QixRQUEyQjs7UUFF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LE9BQU8sQ0FBQyxPQUFBLFFBQVEsQ0FBQyxLQUFLLDBDQUFFLE1BQU0sS0FBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQzFDLFVBQUMsS0FBSyxJQUFLLE9BQUEsS0FBSyxDQUFDLElBQUksS0FBSyw4QkFBOEIsRUFBN0MsQ0FBNkMsQ0FDekQsQ0FBQztJQUNKLENBQUM7SUFFRCx1Q0FBVyxHQUFYO1FBQ0UscUJBQW9CO0lBQ3RCLENBQUM7O0lBeEdVLGlCQUFpQjtRQUg3QixVQUFVLENBQUM7WUFDVixVQUFVLEVBQUUsTUFBTTtTQUNuQixDQUFDO09BQ1csaUJBQWlCLENBeUc3Qjs0QkF2SEQ7Q0F1SEMsQUF6R0QsQ0FBdUMsZ0JBQWdCLEdBeUd0RDtTQXpHWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSwgSHR0cFJlcXVlc3QgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgaXNDYXJ0Tm90Rm91bmRFcnJvciB9IGZyb20gJy4uLy4uLy4uLy4uL2NhcnQvdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBFcnJvck1vZGVsIH0gZnJvbSAnLi4vLi4vLi4vLi4vbW9kZWwvbWlzYy5tb2RlbCc7XHJcbmltcG9ydCB7IFByaW9yaXR5IH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbC9hcHBsaWNhYmxlJztcclxuaW1wb3J0IHsgR2xvYmFsTWVzc2FnZVR5cGUgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvZ2xvYmFsLW1lc3NhZ2UubW9kZWwnO1xyXG5pbXBvcnQgeyBIdHRwUmVzcG9uc2VTdGF0dXMgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvcmVzcG9uc2Utc3RhdHVzLm1vZGVsJztcclxuaW1wb3J0IHsgSHR0cEVycm9ySGFuZGxlciB9IGZyb20gJy4uL2h0dHAtZXJyb3IuaGFuZGxlcic7XHJcblxyXG5jb25zdCBPQVVUSF9FTkRQT0lOVCA9ICcvYXV0aG9yaXphdGlvbnNlcnZlci9vYXV0aC90b2tlbic7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQmFkUmVxdWVzdEhhbmRsZXIgZXh0ZW5kcyBIdHRwRXJyb3JIYW5kbGVyIHtcclxuICByZXNwb25zZVN0YXR1cyA9IEh0dHBSZXNwb25zZVN0YXR1cy5CQURfUkVRVUVTVDtcclxuXHJcbiAgaGFuZGxlRXJyb3IocmVxdWVzdDogSHR0cFJlcXVlc3Q8YW55PiwgcmVzcG9uc2U6IEh0dHBFcnJvclJlc3BvbnNlKTogdm9pZCB7XHJcbiAgICB0aGlzLmhhbmRsZUJhZFBhc3N3b3JkKHJlcXVlc3QsIHJlc3BvbnNlKTtcclxuICAgIHRoaXMuaGFuZGxlQmFkTG9naW5SZXNwb25zZShyZXF1ZXN0LCByZXNwb25zZSk7XHJcbiAgICB0aGlzLmhhbmRsZUJhZENhcnRSZXF1ZXN0KHJlcXVlc3QsIHJlc3BvbnNlKTtcclxuICAgIHRoaXMuaGFuZGxlVmFsaWRhdGlvbkVycm9yKHJlcXVlc3QsIHJlc3BvbnNlKTtcclxuICAgIHRoaXMuaGFuZGxlVm91Y2hlck9wZXJhdGlvbkVycm9yKHJlcXVlc3QsIHJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBoYW5kbGVCYWRQYXNzd29yZChcclxuICAgIHJlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sXHJcbiAgICByZXNwb25zZTogSHR0cEVycm9yUmVzcG9uc2VcclxuICApOiB2b2lkIHtcclxuICAgIGlmIChcclxuICAgICAgcmVzcG9uc2UudXJsPy5pbmNsdWRlcyhPQVVUSF9FTkRQT0lOVCkgJiZcclxuICAgICAgcmVzcG9uc2UuZXJyb3I/LmVycm9yID09PSAnaW52YWxpZF9ncmFudCcgJiZcclxuICAgICAgcmVxdWVzdC5ib2R5Py5nZXQoJ2dyYW50X3R5cGUnKSA9PT0gJ3Bhc3N3b3JkJ1xyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuZ2xvYmFsTWVzc2FnZVNlcnZpY2UuYWRkKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGtleTogJ2h0dHBIYW5kbGVycy5iYWRSZXF1ZXN0UGxlYXNlTG9naW5BZ2FpbicsXHJcbiAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlOlxyXG4gICAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yLmVycm9yX2Rlc2NyaXB0aW9uIHx8IHJlc3BvbnNlLm1lc3NhZ2UgfHwgJycsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgR2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcclxuICAgICAgKTtcclxuICAgICAgdGhpcy5nbG9iYWxNZXNzYWdlU2VydmljZS5yZW1vdmUoR2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfQ09ORklSTUFUSU9OKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBoYW5kbGVCYWRMb2dpblJlc3BvbnNlKFxyXG4gICAgX3JlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sXHJcbiAgICByZXNwb25zZTogSHR0cEVycm9yUmVzcG9uc2VcclxuICApIHtcclxuICAgIHRoaXMuZ2V0RXJyb3JzKHJlc3BvbnNlKVxyXG4gICAgICAuZmlsdGVyKChlcnJvcikgPT4gZXJyb3IudHlwZSA9PT0gJ1Bhc3N3b3JkTWlzbWF0Y2hFcnJvcicpXHJcbiAgICAgIC5mb3JFYWNoKCgpID0+IHtcclxuICAgICAgICB0aGlzLmdsb2JhbE1lc3NhZ2VTZXJ2aWNlLmFkZChcclxuICAgICAgICAgIHsga2V5OiAnaHR0cEhhbmRsZXJzLmJhZFJlcXVlc3RPbGRQYXNzd29yZEluY29ycmVjdCcgfSxcclxuICAgICAgICAgIEdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0VSUk9SXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaGFuZGxlVmFsaWRhdGlvbkVycm9yKFxyXG4gICAgX3JlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sXHJcbiAgICByZXNwb25zZTogSHR0cEVycm9yUmVzcG9uc2VcclxuICApOiB2b2lkIHtcclxuICAgIHRoaXMuZ2V0RXJyb3JzKHJlc3BvbnNlKVxyXG4gICAgICAuZmlsdGVyKChlKSA9PiBlLnR5cGUgPT09ICdWYWxpZGF0aW9uRXJyb3InKVxyXG4gICAgICAuZm9yRWFjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICB0aGlzLmdsb2JhbE1lc3NhZ2VTZXJ2aWNlLmFkZChcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAga2V5OiBgaHR0cEhhbmRsZXJzLnZhbGlkYXRpb25FcnJvcnMuJHtlcnJvci5yZWFzb259LiR7ZXJyb3Iuc3ViamVjdH1gLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIEdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0VSUk9SXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaGFuZGxlQmFkQ2FydFJlcXVlc3QoXHJcbiAgICBfcmVxdWVzdDogSHR0cFJlcXVlc3Q8YW55PixcclxuICAgIHJlc3BvbnNlOiBIdHRwRXJyb3JSZXNwb25zZVxyXG4gICk6IHZvaWQge1xyXG4gICAgdGhpcy5nZXRFcnJvcnMocmVzcG9uc2UpXHJcbiAgICAgIC5maWx0ZXIoKGUpID0+IGlzQ2FydE5vdEZvdW5kRXJyb3IoZSkpXHJcbiAgICAgIC5mb3JFYWNoKCgpID0+IHtcclxuICAgICAgICB0aGlzLmdsb2JhbE1lc3NhZ2VTZXJ2aWNlLmFkZChcclxuICAgICAgICAgIHsga2V5OiAnaHR0cEhhbmRsZXJzLmNhcnROb3RGb3VuZCcgfSxcclxuICAgICAgICAgIEdsb2JhbE1lc3NhZ2VUeXBlLk1TR19UWVBFX0VSUk9SXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaGFuZGxlVm91Y2hlck9wZXJhdGlvbkVycm9yKFxyXG4gICAgX3JlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sXHJcbiAgICByZXNwb25zZTogSHR0cEVycm9yUmVzcG9uc2VcclxuICApOiB2b2lkIHtcclxuICAgIHRoaXMuZ2V0RXJyb3JzKHJlc3BvbnNlKVxyXG4gICAgICAuZmlsdGVyKFxyXG4gICAgICAgIChlKSA9PlxyXG4gICAgICAgICAgZS5tZXNzYWdlID09PSAnY291cG9uLmludmFsaWQuY29kZS5wcm92aWRlZCcgJiZcclxuICAgICAgICAgIGUudHlwZSA9PT0gJ1ZvdWNoZXJPcGVyYXRpb25FcnJvcidcclxuICAgICAgKVxyXG4gICAgICAuZm9yRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbG9iYWxNZXNzYWdlU2VydmljZS5hZGQoXHJcbiAgICAgICAgICB7IGtleTogJ2h0dHBIYW5kbGVycy5pbnZhbGlkQ29kZVByb3ZpZGVkJyB9LFxyXG4gICAgICAgICAgR2xvYmFsTWVzc2FnZVR5cGUuTVNHX1RZUEVfRVJST1JcclxuICAgICAgICApO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBnZXRFcnJvcnMocmVzcG9uc2U6IEh0dHBFcnJvclJlc3BvbnNlKTogRXJyb3JNb2RlbFtdIHtcclxuICAgIHJldHVybiAocmVzcG9uc2UuZXJyb3I/LmVycm9ycyB8fCBbXSkuZmlsdGVyKFxyXG4gICAgICAoZXJyb3IpID0+IGVycm9yLnR5cGUgIT09ICdKYWxvT2JqZWN0Tm9Mb25nZXJWYWxpZEVycm9yJ1xyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldFByaW9yaXR5KCk6IFByaW9yaXR5IHtcclxuICAgIHJldHVybiBQcmlvcml0eS5MT1c7XHJcbiAgfVxyXG59XHJcbiJdfQ==